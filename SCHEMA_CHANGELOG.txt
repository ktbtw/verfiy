# æ•°æ®åº“ Schema æ›´æ–°æ—¥å¿—

## å½“å‰ç‰ˆæœ¬: v2.0 (2025-11-04)

### âœ… å·²å®Œæˆçš„æ›´æ–°

æ‰€æœ‰å¢é‡è¿ç§»è„šæœ¬å·²æ•´åˆåˆ° `database-schema.sql` ä¸»è„šæœ¬ä¸­ã€‚

### ğŸ“‹ ä¸»è¦å˜æ›´å†…å®¹

#### 1. application è¡¨
- âœ… æ–°å¢ `update_url` VARCHAR(512) - æ›´æ–°ä¸‹è½½é“¾æ¥

#### 2. hook_info è¡¨
- âœ… ä¿®æ”¹ `dex_data` LONGTEXT â†’ VARCHAR(255) - å­˜å‚¨æ–‡ä»¶è·¯å¾„
- âœ… æ–°å¢ `dex_hash` VARCHAR(64) - Dex æ–‡ä»¶ SHA-256 å“ˆå¸Œå€¼
- âœ… ä¿®æ”¹ `zip_data` LONGTEXT â†’ VARCHAR(255) - å­˜å‚¨æ–‡ä»¶è·¯å¾„
- âœ… æ–°å¢ç´¢å¼• `idx_dex_hash` - ä¼˜åŒ–å“ˆå¸ŒæŸ¥è¯¢

#### 3. users è¡¨
- âœ… æ–°å¢ `can_invite` TINYINT(1) - é‚€è¯·æƒé™
- âœ… æ–°å¢ `invite_quota` INT - é‚€è¯·é…é¢

#### 4. dex_compile_task è¡¨ï¼ˆæ–°å¢ï¼‰
- âœ… å®Œæ•´çš„ Dex ç¼–è¯‘ä»»åŠ¡è¡¨
- âœ… åŒ…å« `user_id`, `task_id`, `java_code` ç­‰å­—æ®µ

### ğŸ—‘ï¸ å·²åˆ é™¤çš„æ–‡ä»¶

ä»¥ä¸‹å•ç‹¬çš„å¢é‡è„šæœ¬å·²åˆ é™¤ï¼ˆå†…å®¹å·²æ•´åˆåˆ°ç»Ÿä¸€è„šæœ¬ï¼‰ï¼š
- database-migration-dex-compile.sql
- database-migration-dex-hash.sql
- database-migration-file-storage.sql
- database-migration-hookinfo.sql
- database-migration-update-url.sql

### ğŸ“¦ ä¿ç•™çš„æ–‡ä»¶

- **database-schema.sql** - å®Œæ•´çš„æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆå…¨æ–°å®‰è£…ä½¿ç”¨ï¼‰
- **database-migration-all.sql** - ç»Ÿä¸€çš„å¢é‡è¿ç§»è„šæœ¬ï¼ˆç°æœ‰æ•°æ®åº“å‡çº§ä½¿ç”¨ï¼‰

### ğŸ“Š å½“å‰æ•°æ®åº“è¡¨åˆ—è¡¨

1. users - ç”¨æˆ·è¡¨
2. application - åº”ç”¨è¡¨
3. hook_info - Hook é…ç½®è¡¨
4. card - å¡å¯†è¡¨
5. card_machine - å¡å¯†æœºå™¨ç è¡¨
6. card_use_log - å¡å¯†ä½¿ç”¨æ—¥å¿—è¡¨
7. notice - å…¬å‘Šè¡¨
8. invite_codes - é‚€è¯·ç è¡¨
9. dex_compile_task - Dex ç¼–è¯‘ä»»åŠ¡è¡¨
10. hook_info_file_backup - æ–‡ä»¶æ•°æ®å¤‡ä»½è¡¨ï¼ˆå¯é€‰åˆ é™¤ï¼‰

### ğŸ”§ ä½¿ç”¨è¯´æ˜

#### åœºæ™¯ 1ï¼šå…¨æ–°å®‰è£…
```bash
mysql -u root -p < database-schema.sql
```

#### åœºæ™¯ 2ï¼šç°æœ‰æ•°æ®åº“å‡çº§
```bash
mysql -u root -p verfiy < database-migration-all.sql
```

#### åœºæ™¯ 3ï¼šå½“å‰ç”Ÿäº§æ•°æ®åº“
å½“å‰ç”Ÿäº§æ•°æ®åº“å·²ä¸è„šæœ¬åŒæ­¥ï¼Œæ— éœ€æ‰§è¡Œä»»ä½•è¿ç§»

#### å¤‡ä»½å»ºè®®
- æ‰§è¡Œè¿ç§»å‰åŠ¡å¿…å¤‡ä»½æ•°æ®åº“
- `hook_info_file_backup` è¡¨ä¼šè‡ªåŠ¨å¤‡ä»½æ–‡ä»¶æ•°æ®ï¼ˆå¦‚éœ€è¿ç§»ï¼‰

### âš ï¸ æ³¨æ„äº‹é¡¹

- `hook_info_file_backup` è¡¨æ˜¯æ–‡ä»¶å­˜å‚¨è¿ç§»æ—¶çš„å¤‡ä»½ï¼Œç¡®è®¤ç³»ç»Ÿç¨³å®šåå¯åˆ é™¤
- é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·ï¼šç”¨æˆ·å adminï¼Œå¯†ç  admin123ï¼ˆè¯·åŠæ—¶ä¿®æ”¹ï¼‰
